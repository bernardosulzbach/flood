The code is very ugly and unoptimized.
Do not add or modify any functionality until refactoring basically everything.
